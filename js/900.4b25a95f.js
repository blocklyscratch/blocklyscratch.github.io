(()=>{"use strict";const a={ok:0,partial:1,all:2,noThisID:3};let e={};function s(a){let s=a.update,t=a.sPhaserID,o=a.gameIDorRoomID,r=!1,d={};if(void 0!=e[t]&&void 0!=e[t][o]){let a=e[t][o];for(let e in s)if(void 0==a[e])a[e]=s[e],d[e]=s[e];else{d[e]={};for(let t in s[e]){let o=s[e][t],m=a[e][t];if(void 0==m){a[e][t]=o,d[e][t]=o,r=!0;break}for(let s in o)if(o[s]!=m[s]){a[e][t]=o,d[e][t]=o,r=!0;break}}}}return r?d:null}self.onmessage=function(t){let o,r,d=t.data;switch(d.cmd){case"init_vue2worker":o=d.data.sPhaserID,r=d.data.gameIDorRoomID,void 0==e[o]&&(e[o]={}),void 0==e[o][r]&&(e[o][r]={}),e[o][r+"Server"]=!1;break;case"destroy_vue2worker":o=d.data.sPhaserID,r=d.data.gameIDorRoomID,void 0!=e[o]&&delete e[o];break;case"phaser_status_2C_p2w":let t=s(d.data);null!=t&&self.postMessage({cmd:"phaser_status_2C_w2s",data:{update:t,mode:a.partial,sPhaserID:d.data.sPhaserID,gameIDorRoomID:d.data.gameIDorRoomID}});break;case"phaser_2S_RES_s2w":if(d.data.update.bBeServer){let a=e[d.data.sPhaserID];void 0!=a&&(a[d.data.gameIDorRoomID+"Server"]=!0,self.postMessage({cmd:"phaser_2S_RES_w2p",data:d.data}))}else self.postMessage({cmd:"phaser_2S_RES_w2p",data:d.data});break;case"phaser_allStatus_REQ_p2w":self.postMessage({cmd:"phaser_allStatus_REQ_w2s",data:{sPhaserID:d.data.sPhaserID,gameIDorRoomID:d.data.gameIDorRoomID}});break;case"phaser_allStatus_REQ_s2w":let m=e[d.data.sPhaserID];if(void 0!=m){let e=m[d.data.gameIDorRoomID];m[d.data.gameIDorRoomID+"Server"]&&self.postMessage({cmd:"phaser_allStatus_RES_w2s",data:{update:e,sPhaserID:d.data.sPhaserID,gameIDorRoomID:d.data.gameIDorRoomID,tempNote:"Out",status:a.ok}})}else for(let s of Object.keys(e)){let t=e[s][d.data.gameIDorRoomID];if(void 0!=t&&e[s][d.data.gameIDorRoomID+"Server"]){self.postMessage({cmd:"phaser_allStatus_RES_w2s",data:{update:t,sPhaserID:d.data.sPhaserID,gameIDorRoomID:d.data.gameIDorRoomID,tempNote:"Out",status:a.ok}});break}}break;default:d.cmd.indexOf("_p2w")>0?self.postMessage({cmd:d.cmd.replace("_p2w","_w2s"),data:d.data}):d.cmd.indexOf("_s2w")>0&&self.postMessage({cmd:d.cmd.replace("_s2w","_w2p"),data:d.data})}}})();